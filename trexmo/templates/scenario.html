{% extends 'layout.html' %}

{% block content %}
<div class="trexmo-scenario col-sm-12" data-name="{{ scenario.name }}" data-id="{{ scenario.id }}">
  <h1 class="page-header">
    <span class="scenario-name">{{ scenario.name }}</span>
    <div class="pull-right">
      <div class="btn-group">
        <button type="button" class="btn btn-success scenario-save" disabled="disabled">Save</button>
        <button type="button" class="btn btn-success scenario-save-as">Save as ...</button>
      </div>
      <button type="button" class="btn btn-warning scenario-reset" disabled="disabled">Reset</button>
      <button type="button" class="btn btn-primary scenario-run">Run</button>
    </div>
  </h1>
  </div>
    <div class="container-fluid">
      <div class="row">
        <form id="scenario-form" role="form">
          <div class="col-sm-6">
            <div class="form-group">
              <label for="input-description">Description</label>
              <textarea id="input-description" name="description" class="form-control" rows="6" placeholder="type a description of the scenario here">{{ scenario.description }}</textarea>
            </div>
          </div>
          <div class="col-sm-6">
            <div class="form-group">
              <label for="date">Date of creation</label>
              <input id="date" readonly class="form-control" type="date" value="{{ scenario.created_at.date().strftime('%d/%m/%y') }}">
            </div>
            <div class="form-group">
              <label for="model">Model</label>
              <select id="model" name="model" class="form-control">
                {% for model in models.values() %}
                <option value="{{ model.name }}" {% if scenario.model == model.name %} selected="selected"{% endif %}>{{ model.label }}</option>
                {% endfor %}
              </select>
              <span class="help-block">Modifying the model may require the translation of the determinants.</span>
            </div>
            <div class="form-group">
              <label for="substance">Substance</label>
              <input id="substance" name="substance" class="form-control" type="text" placeholder="Name of the substance" value="{{ scenario.substance }}">
            </div>
            <div class="form-group">
              <label for="cas">CAS</label>
              <input id="cas" name="cas" class="form-control" type="text" placeholder="CAS number of the substance" value="{{ scenario.cas }}">
            </div>
          </div>
        </form>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <ul class="nav nav-tabs scenario-model-data" style="margin-bottom:12px" role="tablist">
            <li class="active"><a href="#determinants" class="scenario-model-determinants" data-toggle="tab">Determinants</a></li>
            <li><a href="#report" class="scenario-model-report" data-toggle="tab">Report</a></li>
          </ul>
          <div class="tab-content">
            <div class="tab-pane fade in active" id="determinants">
              {% if form %}
              <h4>Determinants for {{ models[scenario.model].label }}</h4>
              {{ form | safe }}
              {% else %}
              <div class="alert alert-danger">
                The formular for the selected model "{{ scenario.model }}" doesn't exist or couldn't be loaded.
              </div>
              {% endif %}
            </div>
            <div class="tab-pane fade" id="report">
              <div class="alert alert-info">
                There is no available report because the model hasn't been run yet.
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock content %}

{% block script %}
<script type="text/javascript" src="{{ url_for('static', filename='jspdf/jspdf.min.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/yaffel.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/form_view.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/scenario.js') }}"></script>
{% endblock script %}